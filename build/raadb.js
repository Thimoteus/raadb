!function(a,b){b.raadb=a;var c,d,e,f,g,h,i,j,k,l,m,n,o,p=require("molten-core"),q=require("./middleware"),r=q.getDbEndpt,s=q.getListing,t=q.createComment,u=q.createSelfText,v=q.getCommentsFromPost,w=q.deleteThing,x=q.editComment,y=!0;d=function(a){return console.log(a),a},e=function(a){return y?d(a):void 0},f=function(a){return a.name},g=function(a){var b;return b=a.body,JSON.parse(p.decode64(b))},h=function(a){return p.encode64(JSON.stringify(a))},i=function(a,b,c){var d,e,f;return d=r(a),e={limit:100},f=function(a,d,e){var f,g;return!a&&d&&200==d.statusCode&&e?(f=function(a){return p.includes(b,a.title)},g=p.filter(f,e),c(a,g)):c(new Error("Could not contact reddit"))},s(d,e,f)},j=function(a,b,c){var e,f;return d("creating new collection "+b),f="This is a collection for [reddit as a database](https://www.github.com/thimoteus/raadb).",e=function(a,b,d){return!a&&b&&200==b.statusCode&&d?c(a,d):c(new Error("Could not contact reddit"))},u(a,b,f,e)},k=function(a,b,c,d){var e;return e=function(e,f){var g;return e?d(e):(g=function(a,b){var c=JSON.parse(b).json.data;d(a,c)},void(0===f.length&&c?j(a,b,g):f.length>0?d(e,f[0]):d(new Error("Collection "+b+" doesn't exist"))))},i(a,[b],e)},l=function(a,b,c,e){var f;return void 0===e&&(e=p.id),d("inserting new doc into "+b+":"),d(c),f=function(a,b){var d,f;return a?e(a):(d=h(c),f=function(a,c,d){var f;return!a&&c&&200==c.statusCode&&d?(f=JSON.parse(d).json.data.things[0].data.name,e(a,b,f)):e(new Error("Could not contact reddit"))},t(b,d,f))},k(a,b,!0,f)},m=function(a,b,c,d){var e,g;if(p.isType("String",c))g=function(a){return f(a)===c};else{if(!p.isType("Function",c))throw new Error("query must be a string or a predicate");g=c}return e=function(b,e){return b?d(b):v(a,e,function(a,b){var e;return e=p.filter(g,b),p.isType("String",c)?d(a,e[0]):d(a,e)})},k(a,b,!1,e)},n=function(a,b,c,d){var e;return e=function(a,b){return a?d(a):(b.length?p.map(function(a){return w(a)},b):w(b),d(a))},m(a,b,c,e)},o=function(a,b,c,d,e){var f,i,j;return i=p.isType("Function",d)?function(a){return h(g(a))}:function(){return h(d)},f=function(a,b){return a?e(a):(b.length?(j=function(a){x(a,i(a))},p.map2(j,b)):x(b,i(b)),e(a))},m(a,b,c,f)},c=function(a){this.docId=f,this.docData=g,this.encodeDoc=h,this.insert=p.curry(l)(a),this.find=p.curry(m)(a),this.remove=p.curry(n)(a),this.update=p.curry(o)(a)},module.exports=c}({},function(){return this}());