!function(a,b){b.raadb=a;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=require("molten-core"),s=require("./middleware"),t=s.getDbEndpt,u=s.getListing,v=s.createComment,w=s.createSelfText,x=s.getCommentsFromPost,y=s.deleteThing,z=s.editComment,A=!0;d=function(a){return console.log(a),a},e=function(a){return A?d(a):void 0},f=function(){var a,b;return a=Date.now().toString(36),b=Math.random(),b=b.toString(36),b=r.Str.drop(2,b),a+b},g=function(a){return r.lines(a.body)[0]},h=function(a){return data=r.lines(a.body)[1],JSON.parse(r.decode64(data))},i=function(a){return r.encode64(JSON.stringify(a))},q=function(a,b){var c,d;return c=i(b),d=r.unlines([a,c])},j=function(a,b,c){var d,e,f;return d=t(a),e={limit:100},f=function(a,d,e){var f,g;return!a&&d&&200==d.statusCode&&e?(f=function(a){return r.includes(b,a.title)},g=r.filter(f,e),c(a,g)):c(new Error("Could not contact reddit"))},u(d,e,f)},k=function(a,b,c){var d;return d=f(),w(a,b,d,c)},l=function(a,b,c,d){var e;return e=function(e,f){var g;return e?d(e):(g=function(a,b,c){var e=JSON.parse(c).json.data;d(a,e)},void(0===f.length&&c?k(a,b,g):f.length>0?d(e,f[0]):d(new Error("Collection "+b+" doesn't exist"))))},j(a,[b],e)},m=function(a,b,c,e){var g;return void 0===e&&(e=r.id),d("inserting new doc into "+b+":"),d(c),g=function(a,b){var d,g;return a?e(a):(d=f(),g=q(d,c),v(b,g),void e(a,b,d))},l(a,b,!0,g)},n=function(a,b,c,d){var e,f;if(r.isType("String",c))f=function(a){return g(a)===c};else{if(!r.isType("Function",c))throw new Error("query must be a string or a predicate");f=c}return e=function(b,e){return b?d(b):void x(a,e,function(a,b){var e;return e=r.filter(f,b),r.isType("String",c)?d(a,e[0]):d(a,e)})},l(a,b,!1,e)},o=function(a,b,c,d){var e;return e=function(a,b){return a?d(a):(b.length?r.map(function(a){return y(a)},b):y(b),d(a))},n(a,b,c,e)},p=function(a,b,c,d,e){var f,i,j;return i=r.isType("Function",d)?function(a){return q(g(a),d(h(a)))}:function(a){return q(g(a),d)},f=function(a,b){return a?e(a):(b.length?(j=function(a){z(a,i(a))},r.map2(j,b)):z(b,i(b)),e(a))},n(a,b,c,f)},c=function(a){this.createId=f,this.docId=g,this.docData=h,this.encodeDoc=i,this.createDoc=q,this.insert=r.curry(m)(a),this.find=r.curry(n)(a),this.remove=r.curry(o)(a),this.update=r.curry(p)(a)},module.exports=c}({},function(){return this}());